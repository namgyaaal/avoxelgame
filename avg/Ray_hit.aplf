Ray_hit←{
     ⎕IO←0 ⋄ (x v)←(⍺ ⍵)⋄d←×v⋄v←|v
     m←1⍴⍨,⍨≢v⋄(0 0⍉m)←⌈v+1|x
     p←↑(⊂0⍴⍨≢v)~⍨↓{(-1|x)(×⍤1)0≠⍵}⍛+⊃⍪/{↑,⍳⍵}¨↓m
     p←↑∪⌊(⊂1|x)+(⊂v)∘×(⊂⍤⍋⍛⌷)(1e10×-⎕CT)∘+⍛,÷v(⌹⍤1)p
     x(+⍤1)(0>d)(-⍤1)⍨d(×⍤1)p
 }
